<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Cosmos</title>
  <link rel="icon" type="image/png" href="https://ethanytangcodes.github.io/cosmos/logo.png">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <style>
    *{margin:0;padding:0;box-sizing:border-box;}
    body{
      height:100vh;display:flex;flex-direction:column;
      align-items:center;justify-content:center;gap:36px;
      background:linear-gradient(135deg,#2d0a1a 0%,#3d1520 50%,#4d1f30 100%);
      font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,sans-serif;
      overflow:hidden;position:relative;color:white;
    }
    body::before{
      content:'';position:fixed;inset:0;z-index:0;
      background:
        radial-gradient(ellipse at 20% 30%,rgba(222,49,99,.18),transparent 50%),
        radial-gradient(ellipse at 80% 70%,rgba(248,131,121,.18),transparent 50%);
      animation:cs 20s ease-in-out infinite;
    }
    @keyframes cs{0%,100%{opacity:1;transform:scale(1);}50%{opacity:.75;transform:scale(1.08);}}
    body::after{
      content:'';position:fixed;inset:0;z-index:0;
      background-image:
        radial-gradient(2px 2px at 15% 25%,rgba(255,255,255,.9),transparent),
        radial-gradient(1px 1px at 55% 65%,rgba(222,49,99,.8),transparent),
        radial-gradient(1px 1px at 80% 10%,rgba(248,131,121,.8),transparent),
        radial-gradient(1px 1px at 40% 80%,rgba(255,255,255,.5),transparent);
      background-size:300% 300%;
      animation:stars 80s linear infinite;opacity:.6;
    }
    @keyframes stars{from{background-position:0 0;}to{background-position:-300% -300%;}}
    .wrap{position:relative;z-index:1;display:flex;flex-direction:column;align-items:center;gap:32px;animation:fadeUp .9s ease both;}
    @keyframes fadeUp{from{opacity:0;transform:translateY(28px);}to{opacity:1;transform:translateY(0);}}
    .brand{display:flex;align-items:center;gap:28px;}
    .brand-icon{
      width:130px;height:130px;
      background:linear-gradient(135deg,#DE3163,#F88379);
      border-radius:28px;padding:10px;
      display:flex;align-items:center;justify-content:center;
      box-shadow:0 0 50px rgba(222,49,99,.7),0 12px 30px rgba(0,0,0,.4);
    }
    .brand-icon img{width:100%;height:100%;object-fit:cover;border-radius:20px;}
    .brand-title{
      font-size:100px;font-weight:900;letter-spacing:-4px;
      background:linear-gradient(90deg,#DE3163,#F88379);
      -webkit-background-clip:text;-webkit-text-fill-color:transparent;
    }
    .hint{
      font-size:15px;color:#b8b8c8;text-align:center;max-width:420px;line-height:1.6;
      background:rgba(45,10,26,.5);backdrop-filter:blur(10px);
      padding:12px 24px;border-radius:10px;border:1px solid rgba(222,49,99,.25);
    }
    .open-btn{
      display:flex;align-items:center;gap:14px;
      padding:18px 44px;border-radius:18px;border:none;cursor:pointer;
      font-weight:800;font-size:19px;
      background:linear-gradient(135deg,#DE3163,#F88379);color:white;
      box-shadow:0 12px 45px rgba(222,49,99,.65);
      transition:all .25s ease;
    }
    .open-btn:hover{transform:translateY(-4px);box-shadow:0 18px 60px rgba(222,49,99,.85);}
  </style>
</head>
<body>
<div class="wrap">
  <div class="brand">
    <div class="brand-icon">
      <img src="https://ethanytangcodes.github.io/cosmos/logo.png" alt="Cosmos">
    </div>
    <h1 class="brand-title">Cosmos</h1>
  </div>
  <p class="hint" id="hint">Allow popups for this site, then click Open Cosmos.</p>
  <button class="open-btn" id="openBtn">
    <i class="fas fa-rocket"></i> Open Cosmos
  </button>
</div>

<script>
  var cached = null;

  // Fetch and cache the app HTML immediately on page load
  var xhr = new XMLHttpRequest();
  xhr.open('GET', 'https://raw.githubusercontent.com/ethanytangcodes/cosmos/refs/heads/main/singlefilecosmos.html', true);
  xhr.onload = function() {
    if (xhr.status === 200) {
      cached = xhr.responseText;
    }
  };
  xhr.send();

  document.getElementById('openBtn').onclick = function() {
    // Open the window FIRST, synchronously, before anything else
    var win = window.open('', '_blank');

    if (!win) {
      document.getElementById('hint').innerHTML = '&#9888; Popups blocked! Click the icon in your address bar to allow popups for this site, then try again.';
      return;
    }

    if (cached) {
      // Write straight away â€” no await, no async, fully synchronous
      win.document.open('text/html', 'replace');
      win.document.write(cached);
      win.document.close();
    } else {
      // Cache not ready yet, navigate directly as fallback
      win.location.href = 'https://raw.githubusercontent.com/ethanytangcodes/cosmos/refs/heads/main/singlefilecosmos.html';
    }
  };
</script>
</body>
</html>
